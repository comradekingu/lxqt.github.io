(function(e){function t(e){var t;var n,r,i;var s=document.cookie.split(";");var o=s.length;for(i=0;i<o;i++){n=s[i].substr(0,s[i].indexOf("="));r=s[i].substr(s[i].indexOf("=")+1);n=n.replace(/^\s+|\s+$/g,"");if(typeof e==="object"&&e instanceof RegExp){if(e.test(n)){t=unescape(r);break}}else if(n==e){t=unescape(r);break}}return t}function n(e,t,n){n=new Date((new Date).getTime()+n);document.cookie=e+"="+escape(t)+"; expires="+n.toUTCString()+"; path=/";return true}function i(e){if(typeof e!=="string"&&typeof e!=="number"&&typeof e==="object"&&!(e instanceof RegExp)){console.error("storage.get(): "+e+" is not a string, number, or regular expression.");return false}return true}function s(e,t,n){if(typeof e!=="string"&&typeof e!=="number"){console.error("storage.set(): "+e+" is not a string or number.");return false}if(typeof t==="object"){console.error("storage.set(): "+t+" is an object.");return false}if(n&&typeof n!=="string"&&typeof n!=="number"){console.error("storage.set(): "+n+" is not a string or number.");return false}return true}function o(e){if(typeof e!=="string"&&typeof e!=="number"&&typeof e==="object"&&!(e instanceof RegExp)){console.error("storage.remove(): "+e+" is not a string, number, or regular expression.");return false}return true}var u=new Date;var a=false;try{if(localStorage&&typeof localStorage==="object"&&localStorage!==null){try{localStorage.setItem(u,u);a=localStorage.getItem(u)==u;localStorage.removeItem(u)}catch(f){}}}catch(f){}var l=false;try{if(sessionStorage&&typeof sessionStorage==="object"&&sessionStorage!==null){try{sessionStorage.setItem(u,u);l=sessionStorage.getItem(u)==u;sessionStorage.removeItem(u)}catch(f){}}}catch(f){}var c={};var h=function(e,t){if(e===undefined){this.name="all";return this}this.name=e;this.dom=t;return this};h.prototype.toString=function(){return this.name};h.prototype.valueOf=function(){return this.dom};h.prototype.sync=function(){e("form [data-store]").each(function(t,n){var r=e(this);var i=e(this).attr("data-store-expiry");var s=i==0?"local":"all";var o=e(this).attr("name");var u=e.storage(s).get(o);var a={name:e(this).attr("name"),get:e.storage(s).get(o)};if(u){u=u=="true"?true:u;u=u=="false"?false:u;if(e(this).is('input[type="checkbox"]')){e(this).prop("checked",u)}else if(e(this).is('input[type="radio"]')){e(this).filter(':not([value="'+u+'"])').prop("checked",false);e(this).filter('[value="'+u+'"]').prop("checked",u)}else if(e(this).is("select")){e(this).children("option:not("+u+")").prop("selected",false);e(this).children('option[value="'+u+'"]').prop("selected",true)}else{e(this).attr("value",u).val(u)}}else{if(e(this).is('input[type="checkbox"]')){a.live=e(this).prop("checked");e.storage(s).set(e(this).attr("name"),e(this).prop("checked"),i);a.set=e.storage(s).get(e(this).attr("name"))}else if(e(this).is('input[type="radio"]')){if(e(this).is(":checked")){e.storage(s).set(e(this).attr("name"),e(this).value(),i)}}else if(e(this).is("select")){if(e(this).children("option").filter(":selected")>=1){e.storage(s).set(e(this).attr("name"),e(this).children("option").filter(":selected").val(),i)}}else{this.set(e(this).attr("name"),e(this).value(),i)}}e(this).closest("form").on("reset",function(){setTimeout(function(){r.change()},0)});e(this).on("change",function(t){if(e(this).is('input[type="checkbox"]')){a.live=e(this).prop("checked");e.storage(s).set(e(this).attr("name"),e(this).prop("checked"),i);a.set=e.storage(s).get(e(this).attr("name"))}else if(e(this).is('input[type="radio"]')){if(e(this).is(":checked")){e.storage(s).set(e(this).attr("name"),e(this).value(),i)}}else if(e(this).is("select")){if(e(this).children("option").filter(":selected")>=1){e.storage(s).set(e(this).attr("name"),e(this).children("option").filter(":selected").val(),i)}}else{e.storage(s).set(e(this).attr("name"),e(this).val(),i)}})})};var p=function(e){if(e&&!c[e]){console.error("storage(): "+e+" is not a supported store.");return}e=e&&c[e]?c[e]:c["all"];return e};if(a&&l){h.prototype.get=function(n){if(typeof n==="object"&&n instanceof RegExp){if(c.cookie&&this.name!==undefined&&this.name!=""&&this.name!=c.all.name&&this.name!=c.cookie.name){return e.storage("cookie").get(n)}else if(!c.cookie){console.error("storage().get(): regular expressions are only supported in the cookie store.");return false}}if(!i(n)){return false}var r;if(this.name===undefined||this.name==""||this.name==c.all.name||this.name==c.local.name){r=localStorage.getItem(n);if(r){return r}if(this.name==c.local.name){return false}}if(this.name===undefined||this.name==""||this.name==c.all.name||this.name==c.session.name){r=sessionStorage.getItem(n);if(r){return r}if(this.name==c.session.name){return false}}r=t(n);if(r){return r}if(this.name==c.cookie.name){return false}};h.prototype.set=function(e,t,r){if(!s(e,t,r)){return false}if(r<=0){localStorage.setItem(e,t);return true}else if(r){n(e,t,r);return true}else{sessionStorage.setItem(e,t);return true}};h.prototype.remove=function(t){if(typeof t==="object"&&t instanceof RegExp){if(c.cookie&&this.name!==undefined&&this.name!=""&&this.name!=c.all.name&&this.name!=c.cookie.name){return e.storage("cookie").remove(t)}else if(!c.cookie){console.error("storage().remove(): regular expressions are only supported in the cookie store.");return false}}if(!o(t)){return false}var r;if(this.name===undefined||this.name==""||this.name==c.all.name||this.name==c.local.name){r=localStorage.getItem(t);if(r){localStorage.removeItem(t);r=true;if(this.name==c.local.name){return true}}}if((this.name===undefined||this.name==""||this.name==c.all.name||this.name==c.session.name)&&!r){r=sessionStorage.getItem(t);if(r){sessionStorage.removeItem(t);r=true;if(this.name==c.session.name){return true}}}if((this.name===undefined||this.name==""||this.name==c.all.name||this.name==c.cookie.name)&&!r){if(this.get(t)){n(t,"",-31536e6);return true}}if(r){return true}console.warn("storage.remove(): "+t+" is not set.");return false};c.all=new h;c.local=new h("local",localStorage);c.session=new h("session",sessionStorage);c.cookie=new h("cookie",sessionStorage)}else if(a&&!l){h.prototype.get=function(n){if(typeof n==="object"&&n instanceof RegExp){if(c.cookie&&this.name!==undefined&&this.name!=""&&this.name!=c.all.name&&this.name!=c.cookie.name){return e.storage("cookie").get(n)}else if(!c.cookie){console.error("storage().get(): regular expressions are only supported in the cookie store.");return false}}if(!i(n)){return false}var r;if(this.name===undefined||this.name==""||this.name==c.all.name||this.name==c.local.name){r=localStorage.getItem(n);if(r){return r}if(this.name==c.local.name){return false}}r=t(n);if(r){return r}if(this.name==c.cookie.name){return false}};h.prototype.set=function(e,t,r){if(!s(e,t,r)){return false}if(r<=0){localStorage.setItem(e,t);return true}else if(r){n(e,t,r);return true}else{document.cookie=e+"="+escape(t)+"; path=/";return true}};h.prototype.remove=function(t){if(typeof t==="object"&&t instanceof RegExp){if(c.cookie&&this.name!==undefined&&this.name!=""&&this.name!=c.all.name&&this.name!=c.cookie.name){return e.storage("cookie").remove(t)}else if(!c.cookie){console.error("storage().remove(): regular expressions are only supported in the cookie store.");return false}}if(!o(t)){return false}var r;if((this.name===undefined||this.name==""||this.name==c.all.name||this.name==c.local.name)&&!r){r=localStorage.getItem(t);if(r){localStorage.removeItem(t);r=true;if(this.name==c.local.name){return true}}}if((this.name===undefined||this.name==""||this.name==c.all.name||this.name==c.cookie.name)&&!r){if(this.get(t)){n(t,"",-31536e6);return true}}if(r){return true}console.warn("storage.remove(): "+t+" is not set.");return false};c.all=new h;c.local=new h("local",localStorage);c.cookie=new h("cookie",sessionStorage)}else if(!a&&l){h.prototype.get=function(n){if(typeof n==="object"&&n instanceof RegExp){if(c.cookie&&this.name!==undefined&&this.name!=""&&this.name!=c.all.name&&this.name!=c.cookie.name){return e.storage("cookie").get(n)}else if(!c.cookie){console.error("storage().get(): regular expressions are only supported in the cookie store.");return false}}if(!i(n)){return false}var r;if(this.name===undefined||this.name==""||this.name==c.all.name||this.name==c.session.name){r=localStorage.getItem(n);if(r){return r}if(this.name==c.local.name){return false}}r=t(n);if(r){return r}if(this.name==c.cookie.name){return false}};h.prototype.set=function(e,t,r){if(!s(e,t,r)){return false}if(r<=0){r=31536e6}if(r){n(e,t,r);return true}else{sessionStorage.setItem(e,t);return true}};h.prototype.remove=function(t){if(typeof t==="object"&&t instanceof RegExp){if(c.cookie&&this.name!==undefined&&this.name!=""&&this.name!=c.all.name&&this.name!=c.cookie.name){return e.storage("cookie").remove(t)}else if(!c.cookie){console.error("storage().remove(): regular expressions are only supported in the cookie store.");return false}}if(!o(t)){return false}var r;if((this.name===undefined||this.name==""||this.name==c.all.name||this.name==c.session.name)&&!r){r=sessionStorage.getItem(t);if(r){sessionStorage.removeItem(t);r=true;if(this.name==c.session.name){return true}}}if((this.name===undefined||this.name==""||this.name==c.all.name||this.name==c.cookie.name)&&!r){if(this.get(t)){n(t,"",-31536e6);return true}}if(r){return true}console.warn("storage.remove(): "+t+" is not set.");return false};c.all=new h;c.session=new h("session",sessionStorage);c.cookie=new h("cookie",sessionStorage)}else{h.prototype.get=function(n){if(typeof n==="object"&&n instanceof RegExp){if(c.cookie&&this.name!==undefined&&this.name!=""&&this.name!=c.all.name&&this.name!=c.cookie.name){return e.storage("cookie").get(n)}else if(!c.cookie){console.error("storage().get(): regular expressions are only supported in the cookie store.");return false}}if(!i(n)){return false}r=t(n);if(r){return r}if(this.name==c.cookie.name){return false}};h.prototype.set=function(e,t,r){if(!s(e,t,r)){return false}if(r<=0){r=31536e6}if(r){n(e,t,r);return true}else{document.cookie=e+"="+escape(t)+"; path=/";return true}};h.prototype.remove=function(t,r){if(typeof t==="object"&&t instanceof RegExp){if(c.cookie&&this.name!==undefined&&this.name!=""&&this.name!=c.all.name&&this.name!=c.cookie.name){return e.storage("cookie").remove(t)}else if(!c.cookie){console.error("storage().remove(): regular expressions are only supported in the cookie store.");return false}}if(!o(t,r)){return false}var i;if(i=this.get(t)){n(t,"",-31536e6);return true}console.warn("storage.remove(): "+t+" is not set.");return false};c.all=new h;c.cookie=new h("cookie",sessionStorage)}e.extend({storage:p});e.storage.get=c["all"].get;e.storage.set=c["all"].set;e.storage.remove=c["all"].remove;e.storage.sync=c["all"].sync;e.storage.sync=h.prototype.sync})(jQuery)